define(["exports","./Math-e9e583a9","./when-23b1aa97"],function(t,S,q){"use strict";function O(t,e,n){this.x=q.defaultValue(t,0),this.y=q.defaultValue(e,0),this.z=q.defaultValue(n,0)}O.fromSpherical=function(t,e){q.defined(e)||(e=new O);var n=t.clock,a=t.cone,r=q.defaultValue(t.magnitude,1),t=r*Math.sin(a);return e.x=t*Math.cos(n),e.y=t*Math.sin(n),e.z=r*Math.cos(a),e},O.fromElements=function(t,e,n,a){return q.defined(a)?(a.x=t,a.y=e,a.z=n,a):new O(t,e,n)},O.fromCartesian4=O.clone=function(t,e){if(q.defined(t))return q.defined(e)?(e.x=t.x,e.y=t.y,e.z=t.z,e):new O(t.x,t.y,t.z)},O.packedLength=3,O.pack=function(t,e,n){return n=q.defaultValue(n,0),e[n++]=t.x,e[n++]=t.y,e[n]=t.z,e},O.unpack=function(t,e,n){return e=q.defaultValue(e,0),(n=!q.defined(n)?new O:n).x=t[e++],n.y=t[e++],n.z=t[e],n},O.packArray=function(t,e){var n=t.length,a=3*n;if(q.defined(e)){if(!Array.isArray(e)&&e.length!==a)throw new S.DeveloperError("If result is a typed array, it must have exactly array.length * 3 elements");e.length!==a&&(e.length=a)}else e=new Array(a);for(var r=0;r<n;++r)O.pack(t[r],e,3*r);return e},O.unpackArray=function(t,e){var n=t.length;q.defined(e)?e.length=n/3:e=new Array(n/3);for(var a=0;a<n;a+=3){var r=a/3;e[r]=O.unpack(t,a,e[r])}return e},O.fromArray=O.unpack,O.maximumComponent=function(t){return Math.max(t.x,t.y,t.z)},O.minimumComponent=function(t){return Math.min(t.x,t.y,t.z)},O.minimumByComponent=function(t,e,n){return n.x=Math.min(t.x,e.x),n.y=Math.min(t.y,e.y),n.z=Math.min(t.z,e.z),n},O.maximumByComponent=function(t,e,n){return n.x=Math.max(t.x,e.x),n.y=Math.max(t.y,e.y),n.z=Math.max(t.z,e.z),n},O.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y+t.z*t.z},O.magnitude=function(t){return Math.sqrt(O.magnitudeSquared(t))};var n=new O;O.distance=function(t,e){return O.subtract(t,e,n),O.magnitude(n)},O.distanceSquared=function(t,e){return O.subtract(t,e,n),O.magnitudeSquared(n)},O.normalize=function(t,e){var n=O.magnitude(t);return e.x=t.x/n,e.y=t.y/n,e.z=t.z/n,e},O.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},O.multiplyComponents=function(t,e,n){return n.x=t.x*e.x,n.y=t.y*e.y,n.z=t.z*e.z,n},O.divideComponents=function(t,e,n){return n.x=t.x/e.x,n.y=t.y/e.y,n.z=t.z/e.z,n},O.add=function(t,e,n){return n.x=t.x+e.x,n.y=t.y+e.y,n.z=t.z+e.z,n},O.subtract=function(t,e,n){return n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z,n},O.multiplyByScalar=function(t,e,n){return n.x=t.x*e,n.y=t.y*e,n.z=t.z*e,n},O.divideByScalar=function(t,e,n){return n.x=t.x/e,n.y=t.y/e,n.z=t.z/e,n},O.negate=function(t,e){return e.x=-t.x,e.y=-t.y,e.z=-t.z,e},O.abs=function(t,e){return e.x=Math.abs(t.x),e.y=Math.abs(t.y),e.z=Math.abs(t.z),e};var r=new O;O.lerp=function(t,e,n,a){return O.multiplyByScalar(e,n,r),a=O.multiplyByScalar(t,1-n,a),O.add(r,a,a)};var a=new O,i=new O;O.angleBetween=function(t,e){O.normalize(t,a),O.normalize(e,i);t=O.dot(a,i),e=O.magnitude(O.cross(a,i,a));return Math.atan2(e,t)};var u=new O;O.mostOrthogonalAxis=function(t,e){t=O.normalize(t,u);return O.abs(t,t),e=t.x<=t.y?t.x<=t.z?O.clone(O.UNIT_X,e):O.clone(O.UNIT_Z,e):t.y<=t.z?O.clone(O.UNIT_Y,e):O.clone(O.UNIT_Z,e)},O.projectVector=function(t,e,n){t=O.dot(t,e)/O.dot(e,e);return O.multiplyByScalar(e,t,n)},O.equals=function(t,e){return t===e||q.defined(t)&&q.defined(e)&&t.x===e.x&&t.y===e.y&&t.z===e.z},O.equalsArray=function(t,e,n){return t.x===e[n]&&t.y===e[n+1]&&t.z===e[n+2]},O.equalsEpsilon=function(t,e,n,a){return t===e||q.defined(t)&&q.defined(e)&&S.CrystalMath.equalsEpsilon(t.x,e.x,n,a)&&S.CrystalMath.equalsEpsilon(t.y,e.y,n,a)&&S.CrystalMath.equalsEpsilon(t.z,e.z,n,a)},O.cross=function(t,e,n){var a=t.x,r=t.y,i=t.z,u=e.x,o=e.y,t=e.z,e=r*t-i*o,t=i*u-a*t,u=a*o-r*u;return n.x=e,n.y=t,n.z=u,n},O.midpoint=function(t,e,n){return n.x=.5*(t.x+e.x),n.y=.5*(t.y+e.y),n.z=.5*(t.z+e.z),n},O.fromDegrees=function(t,e,n,a,r){return t=S.CrystalMath.toRadians(t),e=S.CrystalMath.toRadians(e),O.fromRadians(t,e,n,a,r)};var o=new O,s=new O,d=new O(40680631590769,40680631590769,40408299984661.445);O.fromRadians=function(t,e,n,a,r){n=q.defaultValue(n,0);var i=q.defined(a)?a.radiiSquared:d,a=Math.cos(e);o.x=a*Math.cos(t),o.y=a*Math.sin(t),o.z=Math.sin(e),o=O.normalize(o,o),O.multiplyComponents(i,o,s);i=Math.sqrt(O.dot(o,s));return s=O.divideByScalar(s,i,s),o=O.multiplyByScalar(o,n,o),q.defined(r)||(r=new O),O.add(s,o,r)},O.fromDegreesArray=function(t,e,n){var a=t.length;q.defined(n)?n.length=a/2:n=new Array(a/2);for(var r=0;r<a;r+=2){var i=t[r],u=t[r+1],o=r/2;n[o]=O.fromDegrees(i,u,0,e,n[o])}return n},O.fromRadiansArray=function(t,e,n){var a=t.length;q.defined(n)?n.length=a/2:n=new Array(a/2);for(var r=0;r<a;r+=2){var i=t[r],u=t[r+1],o=r/2;n[o]=O.fromRadians(i,u,0,e,n[o])}return n},O.fromDegreesArrayHeights=function(t,e,n){var a=t.length;q.defined(n)?n.length=a/3:n=new Array(a/3);for(var r=0;r<a;r+=3){var i=t[r],u=t[r+1],o=t[r+2],s=r/3;n[s]=O.fromDegrees(i,u,o,e,n[s])}return n},O.fromRadiansArrayHeights=function(t,e,n){var a=t.length;q.defined(n)?n.length=a/3:n=new Array(a/3);for(var r=0;r<a;r+=3){var i=t[r],u=t[r+1],o=t[r+2],s=r/3;n[s]=O.fromRadians(i,u,o,e,n[s])}return n},O.ZERO=Object.freeze(new O(0,0,0)),O.UNIT_X=Object.freeze(new O(1,0,0)),O.UNIT_Y=Object.freeze(new O(0,1,0)),O.UNIT_Z=Object.freeze(new O(0,0,1)),O.prototype.clone=function(t){return O.clone(this,t)},O.prototype.equals=function(t){return O.equals(this,t)},O.prototype.equalsEpsilon=function(t,e,n){return O.equalsEpsilon(this,t,e,n)},O.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};var T=new O,A=new O;function l(t,e,n,a,r){var i=t.x,u=t.y,o=t.z,s=e.x,d=e.y,e=e.z,l=i*i*s*s,h=u*u*d*d,f=o*o*e*e,s=l+h+f,d=Math.sqrt(1/s),e=O.multiplyByScalar(t,d,T);if(s<a)return isFinite(d)?O.clone(e,r):void 0;var c=n.x,y=n.y,m=n.z,n=A;n.x=e.x*c*2,n.y=e.y*y*2,n.z=e.z*m*2;var p=(1-d)*O.magnitude(t)/(.5*O.magnitude(n)),g=0;do{var M,x,w,v,_,C,z,g=(z=l*(v=(M=1/(1+(p-=g)*c))*M)+h*(_=(x=1/(1+p*y))*x)+f*(C=(w=1/(1+p*m))*w)-1)/(-2*(l*(v*M)*c+h*(_*x)*y+f*(C*w)*m))}while(Math.abs(z)>S.CrystalMath.EPSILON12);return q.defined(r)?(r.x=i*M,r.y=u*x,r.z=o*w,r):new O(i*M,u*x,o*w)}function h(t,e,n){this.longitude=q.defaultValue(t,0),this.latitude=q.defaultValue(e,0),this.height=q.defaultValue(n,0)}h.fromRadians=function(t,e,n,a){return n=q.defaultValue(n,0),q.defined(a)?(a.longitude=t,a.latitude=e,a.height=n,a):new h(t,e,n)},h.fromDegrees=function(t,e,n,a){return t=S.CrystalMath.toRadians(t),e=S.CrystalMath.toRadians(e),h.fromRadians(t,e,n,a)};var f=new O,c=new O,y=new O,m=new O(1/6378137,1/6378137,1/6356752.314245179),p=new O(1/40680631590769,1/40680631590769,1/40408299984661.445),g=S.CrystalMath.EPSILON1;function M(t,e,n,a){e=q.defaultValue(e,0),n=q.defaultValue(n,0),a=q.defaultValue(a,0),t._radii=new O(e,n,a),t._radiiSquared=new O(e*e,n*n,a*a),t._radiiToTheFourth=new O(e*e*e*e,n*n*n*n,a*a*a*a),t._oneOverRadii=new O(0===e?0:1/e,0===n?0:1/n,0===a?0:1/a),t._oneOverRadiiSquared=new O(0===e?0:1/(e*e),0===n?0:1/(n*n),0===a?0:1/(a*a)),t._minimumRadius=Math.min(e,n,a),t._maximumRadius=Math.max(e,n,a),t._centerToleranceSquared=S.CrystalMath.EPSILON1,0!==t._radiiSquared.z&&(t._squaredXOverSquaredZ=t._radiiSquared.x/t._radiiSquared.z)}function x(t,e,n){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,M(this,t,e,n)}h.fromCartesian=function(t,e,n){var a=q.defined(e)?e.oneOverRadii:m,r=q.defined(e)?e.oneOverRadiiSquared:p,a=l(t,a,r,q.defined(e)?e._centerToleranceSquared:g,c);if(q.defined(a)){e=O.multiplyComponents(a,r,f),e=O.normalize(e,e),r=O.subtract(t,a,y),a=Math.atan2(e.y,e.x),e=Math.asin(e.z),r=S.CrystalMath.sign(O.dot(r,t))*O.magnitude(r);return q.defined(n)?(n.longitude=a,n.latitude=e,n.height=r,n):new h(a,e,r)}},h.toCartesian=function(t,e,n){return O.fromRadians(t.longitude,t.latitude,t.height,e,n)},h.clone=function(t,e){if(q.defined(t))return q.defined(e)?(e.longitude=t.longitude,e.latitude=t.latitude,e.height=t.height,e):new h(t.longitude,t.latitude,t.height)},h.equals=function(t,e){return t===e||q.defined(t)&&q.defined(e)&&t.longitude===e.longitude&&t.latitude===e.latitude&&t.height===e.height},h.equalsEpsilon=function(t,e,n){return n=q.defaultValue(n,0),t===e||q.defined(t)&&q.defined(e)&&Math.abs(t.longitude-e.longitude)<=n&&Math.abs(t.latitude-e.latitude)<=n&&Math.abs(t.height-e.height)<=n},h.ZERO=Object.freeze(new h(0,0,0)),h.prototype.clone=function(t){return h.clone(this,t)},h.prototype.equals=function(t){return h.equals(this,t)},h.prototype.equalsEpsilon=function(t,e){return h.equalsEpsilon(this,t,e)},h.prototype.toString=function(){return"("+this.longitude+", "+this.latitude+", "+this.height+")"},Object.defineProperties(x.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}}),x.clone=function(t,e){if(q.defined(t)){var n=t._radii;return q.defined(e)?(O.clone(n,e._radii),O.clone(t._radiiSquared,e._radiiSquared),O.clone(t._radiiToTheFourth,e._radiiToTheFourth),O.clone(t._oneOverRadii,e._oneOverRadii),O.clone(t._oneOverRadiiSquared,e._oneOverRadiiSquared),e._minimumRadius=t._minimumRadius,e._maximumRadius=t._maximumRadius,e._centerToleranceSquared=t._centerToleranceSquared,e):new x(n.x,n.y,n.z)}},x.fromCartesian3=function(t,e){return q.defined(e)||(e=new x),q.defined(t)&&M(e,t.x,t.y,t.z),e},x.WGS84=Object.freeze(new x(6378137,6378137,6356752.314245179)),x.UNIT_SPHERE=Object.freeze(new x(1,1,1)),x.MOON=Object.freeze(new x(S.CrystalMath.LUNAR_RADIUS,S.CrystalMath.LUNAR_RADIUS,S.CrystalMath.LUNAR_RADIUS)),x.prototype.clone=function(t){return x.clone(this,t)},x.packedLength=O.packedLength,x.pack=function(t,e,n){return n=q.defaultValue(n,0),O.pack(t._radii,e,n),e},x.unpack=function(t,e,n){e=q.defaultValue(e,0);e=O.unpack(t,e);return x.fromCartesian3(e,n)},x.prototype.geocentricSurfaceNormal=O.normalize,x.prototype.geodeticSurfaceNormalCartographic=function(t,e){var n=t.longitude,a=t.latitude,r=Math.cos(a),t=r*Math.cos(n),n=r*Math.sin(n),a=Math.sin(a);return(e=!q.defined(e)?new O:e).x=t,e.y=n,e.z=a,O.normalize(e,e)},x.prototype.geodeticSurfaceNormal=function(t,e){if(!O.equalsEpsilon(t,O.ZERO,S.CrystalMath.EPSILON14))return q.defined(e)||(e=new O),e=O.multiplyComponents(t,this._oneOverRadiiSquared,e),O.normalize(e,e)};var w=new O,v=new O;x.prototype.cartographicToCartesian=function(t,e){var n=w,a=v;this.geodeticSurfaceNormalCartographic(t,n),O.multiplyComponents(this._radiiSquared,n,a);var r=Math.sqrt(O.dot(n,a));return O.divideByScalar(a,r,a),O.multiplyByScalar(n,t.height,n),q.defined(e)||(e=new O),O.add(a,n,e)},x.prototype.cartographicArrayToCartesianArray=function(t,e){var n=t.length;q.defined(e)?e.length=n:e=new Array(n);for(var a=0;a<n;a++)e[a]=this.cartographicToCartesian(t[a],e[a]);return e};var _=new O,C=new O,z=new O;x.prototype.cartesianToCartographic=function(t,e){var n=this.scaleToGeodeticSurface(t,C);if(q.defined(n)){var a=this.geodeticSurfaceNormal(n,_),r=O.subtract(t,n,z),n=Math.atan2(a.y,a.x),a=Math.asin(a.z),r=S.CrystalMath.sign(O.dot(r,t))*O.magnitude(r);return q.defined(e)?(e.longitude=n,e.latitude=a,e.height=r,e):new h(n,a,r)}},x.prototype.cartesianArrayToCartographicArray=function(t,e){var n=t.length;q.defined(e)?e.length=n:e=new Array(n);for(var a=0;a<n;++a)e[a]=this.cartesianToCartographic(t[a],e[a]);return e},x.prototype.scaleToGeodeticSurface=function(t,e){return l(t,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,e)},x.prototype.scaleToGeocentricSurface=function(t,e){q.defined(e)||(e=new O);var n=t.x,a=t.y,r=t.z,i=this._oneOverRadiiSquared,i=1/Math.sqrt(n*n*i.x+a*a*i.y+r*r*i.z);return O.multiplyByScalar(t,i,e)},x.prototype.transformPositionToScaledSpace=function(t,e){return q.defined(e)||(e=new O),O.multiplyComponents(t,this._oneOverRadii,e)},x.prototype.transformPositionFromScaledSpace=function(t,e){return q.defined(e)||(e=new O),O.multiplyComponents(t,this._radii,e)},x.prototype.equals=function(t){return this===t||q.defined(t)&&O.equals(this._radii,t._radii)},x.prototype.toString=function(){return this._radii.toString()},x.prototype.getSurfaceNormalIntersectionWithZAxis=function(t,e,n){e=q.defaultValue(e,0);var a=this._squaredXOverSquaredZ;if((n=!q.defined(n)?new O:n).x=0,n.y=0,n.z=t.z*(1-a),!(Math.abs(n.z)>=this._radii.z-e))return n};var R=[.14887433898163,.43339539412925,.67940956829902,.86506336668898,.97390652851717,0],V=[.29552422471475,.26926671930999,.21908636251598,.14945134915058,.066671344308684,0];function b(t,e,n){for(var a=.5*(e+t),r=.5*(e-t),i=0,u=0;u<5;u++){var o=r*R[u];i+=V[u]*(n(a+o)+n(a-o))}return i*=r}function I(t,e,n,a){this.west=q.defaultValue(t,0),this.south=q.defaultValue(e,0),this.east=q.defaultValue(n,0),this.north=q.defaultValue(a,0)}x.prototype.surfaceArea=function(t){for(var e=t.west,r=t.east,n=t.south,a=t.north;r<e;)r+=S.CrystalMath.TWO_PI;var t=this._radiiSquared,i=t.x,u=t.y,o=t.z,s=i*u;return b(n,a,function(t){var n=Math.cos(t),a=Math.sin(t);return Math.cos(t)*b(e,r,function(t){var e=Math.cos(t),t=Math.sin(t);return Math.sqrt(s*a*a+o*(u*e*e+i*t*t)*n*n)})})},Object.defineProperties(I.prototype,{width:{get:function(){return I.computeWidth(this)}},height:{get:function(){return I.computeHeight(this)}}}),I.packedLength=4,I.pack=function(t,e,n){return n=q.defaultValue(n,0),e[n++]=t.west,e[n++]=t.south,e[n++]=t.east,e[n]=t.north,e},I.unpack=function(t,e,n){return e=q.defaultValue(e,0),(n=!q.defined(n)?new I:n).west=t[e++],n.south=t[e++],n.east=t[e++],n.north=t[e],n},I.computeWidth=function(t){var e=t.east,t=t.west;return e<t&&(e+=S.CrystalMath.TWO_PI),e-t},I.computeHeight=function(t){return t.north-t.south},I.fromDegrees=function(t,e,n,a,r){return t=S.CrystalMath.toRadians(q.defaultValue(t,0)),e=S.CrystalMath.toRadians(q.defaultValue(e,0)),n=S.CrystalMath.toRadians(q.defaultValue(n,0)),a=S.CrystalMath.toRadians(q.defaultValue(a,0)),q.defined(r)?(r.west=t,r.south=e,r.east=n,r.north=a,r):new I(t,e,n,a)},I.fromRadians=function(t,e,n,a,r){return q.defined(r)?(r.west=q.defaultValue(t,0),r.south=q.defaultValue(e,0),r.east=q.defaultValue(n,0),r.north=q.defaultValue(a,0),r):new I(t,e,n,a)},I.fromCartographicArray=function(t,e){for(var n=Number.MAX_VALUE,a=-Number.MAX_VALUE,r=Number.MAX_VALUE,i=-Number.MAX_VALUE,u=Number.MAX_VALUE,o=-Number.MAX_VALUE,s=0,d=t.length;s<d;s++)var l=t[s],n=Math.min(n,l.longitude),a=Math.max(a,l.longitude),u=Math.min(u,l.latitude),o=Math.max(o,l.latitude),l=0<=l.longitude?l.longitude:l.longitude+S.CrystalMath.TWO_PI,r=Math.min(r,l),i=Math.max(i,l);return i-r<a-n&&(n=r,(a=i)>S.CrystalMath.PI&&(a-=S.CrystalMath.TWO_PI),n>S.CrystalMath.PI&&(n-=S.CrystalMath.TWO_PI)),q.defined(e)?(e.west=n,e.south=u,e.east=a,e.north=o,e):new I(n,u,a,o)},I.fromCartesianArray=function(t,e,n){e=q.defaultValue(e,x.WGS84);for(var a=Number.MAX_VALUE,r=-Number.MAX_VALUE,i=Number.MAX_VALUE,u=-Number.MAX_VALUE,o=Number.MAX_VALUE,s=-Number.MAX_VALUE,d=0,l=t.length;d<l;d++)var h=e.cartesianToCartographic(t[d]),a=Math.min(a,h.longitude),r=Math.max(r,h.longitude),o=Math.min(o,h.latitude),s=Math.max(s,h.latitude),h=0<=h.longitude?h.longitude:h.longitude+S.CrystalMath.TWO_PI,i=Math.min(i,h),u=Math.max(u,h);return u-i<r-a&&(a=i,(r=u)>S.CrystalMath.PI&&(r-=S.CrystalMath.TWO_PI),a>S.CrystalMath.PI&&(a-=S.CrystalMath.TWO_PI)),q.defined(n)?(n.west=a,n.south=o,n.east=r,n.north=s,n):new I(a,o,r,s)},I.clone=function(t,e){if(q.defined(t))return q.defined(e)?(e.west=t.west,e.south=t.south,e.east=t.east,e.north=t.north,e):new I(t.west,t.south,t.east,t.north)},I.equalsEpsilon=function(t,e,n){return n=q.defaultValue(n,0),t===e||q.defined(t)&&q.defined(e)&&Math.abs(t.west-e.west)<=n&&Math.abs(t.south-e.south)<=n&&Math.abs(t.east-e.east)<=n&&Math.abs(t.north-e.north)<=n},I.prototype.clone=function(t){return I.clone(this,t)},I.prototype.equals=function(t){return I.equals(this,t)},I.equals=function(t,e){return t===e||q.defined(t)&&q.defined(e)&&t.west===e.west&&t.south===e.south&&t.east===e.east&&t.north===e.north},I.prototype.equalsEpsilon=function(t,e){return I.equalsEpsilon(this,t,e)},I.validate=function(t){},I.southwest=function(t,e){return q.defined(e)?(e.longitude=t.west,e.latitude=t.south,e.height=0,e):new h(t.west,t.south)},I.northwest=function(t,e){return q.defined(e)?(e.longitude=t.west,e.latitude=t.north,e.height=0,e):new h(t.west,t.north)},I.northeast=function(t,e){return q.defined(e)?(e.longitude=t.east,e.latitude=t.north,e.height=0,e):new h(t.east,t.north)},I.southeast=function(t,e){return q.defined(e)?(e.longitude=t.east,e.latitude=t.south,e.height=0,e):new h(t.east,t.south)},I.center=function(t,e){var n=t.east,a=t.west;n<a&&(n+=S.CrystalMath.TWO_PI);n=S.CrystalMath.negativePiToPi(.5*(a+n)),t=.5*(t.south+t.north);return q.defined(e)?(e.longitude=n,e.latitude=t,e.height=0,e):new h(n,t)},I.intersection=function(t,e,n){var a=t.east,r=t.west,i=e.east,u=e.west;a<r&&0<i?a+=S.CrystalMath.TWO_PI:i<u&&0<a&&(i+=S.CrystalMath.TWO_PI),a<r&&u<0?u+=S.CrystalMath.TWO_PI:i<u&&r<0&&(r+=S.CrystalMath.TWO_PI);u=S.CrystalMath.negativePiToPi(Math.max(r,u)),a=S.CrystalMath.negativePiToPi(Math.min(a,i));if(!((t.west<t.east||e.west<e.east)&&a<=u)){i=Math.max(t.south,e.south),e=Math.min(t.north,e.north);if(!(e<=i))return q.defined(n)?(n.west=u,n.south=i,n.east=a,n.north=e,n):new I(u,i,a,e)}},I.simpleIntersection=function(t,e,n){var a=Math.max(t.west,e.west),r=Math.max(t.south,e.south),i=Math.min(t.east,e.east),e=Math.min(t.north,e.north);if(!(e<=r||i<=a))return q.defined(n)?(n.west=a,n.south=r,n.east=i,n.north=e,n):new I(a,r,i,e)},I.union=function(t,e,n){q.defined(n)||(n=new I);var a=t.east,r=t.west,i=e.east,u=e.west;a<r&&0<i?a+=S.CrystalMath.TWO_PI:i<u&&0<a&&(i+=S.CrystalMath.TWO_PI),a<r&&u<0?u+=S.CrystalMath.TWO_PI:i<u&&r<0&&(r+=S.CrystalMath.TWO_PI);u=S.CrystalMath.convertLongitudeRange(Math.min(r,u)),i=S.CrystalMath.convertLongitudeRange(Math.max(a,i));return n.west=u,n.south=Math.min(t.south,e.south),n.east=i,n.north=Math.max(t.north,e.north),n},I.expand=function(t,e,n){return(n=!q.defined(n)?new I:n).west=Math.min(t.west,e.longitude),n.south=Math.min(t.south,e.latitude),n.east=Math.max(t.east,e.longitude),n.north=Math.max(t.north,e.latitude),n},I.contains=function(t,e){var n=e.longitude,a=e.latitude,r=t.west,e=t.east;return e<r&&(e+=S.CrystalMath.TWO_PI,n<0&&(n+=S.CrystalMath.TWO_PI)),(r<n||S.CrystalMath.equalsEpsilon(n,r,S.CrystalMath.EPSILON14))&&(n<e||S.CrystalMath.equalsEpsilon(n,e,S.CrystalMath.EPSILON14))&&a>=t.south&&a<=t.north};var E=new h;function P(t,e){this.x=q.defaultValue(t,0),this.y=q.defaultValue(e,0)}I.subsample=function(t,e,n,a){e=q.defaultValue(e,x.WGS84),n=q.defaultValue(n,0),q.defined(a)||(a=[]);var r=0,i=t.north,u=t.south,o=t.east,s=t.west,d=E;d.height=n,d.longitude=s,d.latitude=i,a[r]=e.cartographicToCartesian(d,a[r]),r++,d.longitude=o,a[r]=e.cartographicToCartesian(d,a[r]),r++,d.latitude=u,a[r]=e.cartographicToCartesian(d,a[r]),r++,d.longitude=s,a[r]=e.cartographicToCartesian(d,a[r]),r++,d.latitude=i<0?i:0<u?u:0;for(var l=1;l<8;++l)d.longitude=-Math.PI+l*S.CrystalMath.PI_OVER_TWO,I.contains(t,d)&&(a[r]=e.cartographicToCartesian(d,a[r]),r++);return 0===d.latitude&&(d.longitude=s,a[r]=e.cartographicToCartesian(d,a[r]),r++,d.longitude=o,a[r]=e.cartographicToCartesian(d,a[r]),r++),a.length=r,a},I.MAX_VALUE=Object.freeze(new I(-Math.PI,-S.CrystalMath.PI_OVER_TWO,Math.PI,S.CrystalMath.PI_OVER_TWO)),P.fromElements=function(t,e,n){return q.defined(n)?(n.x=t,n.y=e,n):new P(t,e)},P.fromCartesian3=P.clone=function(t,e){if(q.defined(t))return q.defined(e)?(e.x=t.x,e.y=t.y,e):new P(t.x,t.y)},P.fromCartesian4=P.clone,P.packedLength=2,P.pack=function(t,e,n){return n=q.defaultValue(n,0),e[n++]=t.x,e[n]=t.y,e},P.unpack=function(t,e,n){return e=q.defaultValue(e,0),(n=!q.defined(n)?new P:n).x=t[e++],n.y=t[e],n},P.packArray=function(t,e){var n=t.length,a=2*n;if(q.defined(e)){if(!Array.isArray(e)&&e.length!==a)throw new S.DeveloperError("If result is a typed array, it must have exactly array.length * 2 elements");e.length!==a&&(e.length=a)}else e=new Array(a);for(var r=0;r<n;++r)P.pack(t[r],e,2*r);return e},P.unpackArray=function(t,e){var n=t.length;q.defined(e)?e.length=n/2:e=new Array(n/2);for(var a=0;a<n;a+=2){var r=a/2;e[r]=P.unpack(t,a,e[r])}return e},P.fromArray=P.unpack,P.maximumComponent=function(t){return Math.max(t.x,t.y)},P.minimumComponent=function(t){return Math.min(t.x,t.y)},P.minimumByComponent=function(t,e,n){return n.x=Math.min(t.x,e.x),n.y=Math.min(t.y,e.y),n},P.maximumByComponent=function(t,e,n){return n.x=Math.max(t.x,e.x),n.y=Math.max(t.y,e.y),n},P.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y},P.magnitude=function(t){return Math.sqrt(P.magnitudeSquared(t))};var N=new P;P.distance=function(t,e){return P.subtract(t,e,N),P.magnitude(N)},P.distanceSquared=function(t,e){return P.subtract(t,e,N),P.magnitudeSquared(N)},P.normalize=function(t,e){var n=P.magnitude(t);return e.x=t.x/n,e.y=t.y/n,e},P.dot=function(t,e){return t.x*e.x+t.y*e.y},P.cross=function(t,e){return t.x*e.y-t.y*e.x},P.multiplyComponents=function(t,e,n){return n.x=t.x*e.x,n.y=t.y*e.y,n},P.divideComponents=function(t,e,n){return n.x=t.x/e.x,n.y=t.y/e.y,n},P.add=function(t,e,n){return n.x=t.x+e.x,n.y=t.y+e.y,n},P.subtract=function(t,e,n){return n.x=t.x-e.x,n.y=t.y-e.y,n},P.multiplyByScalar=function(t,e,n){return n.x=t.x*e,n.y=t.y*e,n},P.divideByScalar=function(t,e,n){return n.x=t.x/e,n.y=t.y/e,n},P.negate=function(t,e){return e.x=-t.x,e.y=-t.y,e},P.abs=function(t,e){return e.x=Math.abs(t.x),e.y=Math.abs(t.y),e};var U=new P;P.lerp=function(t,e,n,a){return P.multiplyByScalar(e,n,U),a=P.multiplyByScalar(t,1-n,a),P.add(U,a,a)};var L=new P,W=new P;P.angleBetween=function(t,e){return P.normalize(t,L),P.normalize(e,W),S.CrystalMath.acosClamped(P.dot(L,W))};var k=new P;P.mostOrthogonalAxis=function(t,e){t=P.normalize(t,k);return P.abs(t,t),e=t.x<=t.y?P.clone(P.UNIT_X,e):P.clone(P.UNIT_Y,e)},P.equals=function(t,e){return t===e||q.defined(t)&&q.defined(e)&&t.x===e.x&&t.y===e.y},P.equalsArray=function(t,e,n){return t.x===e[n]&&t.y===e[n+1]},P.equalsEpsilon=function(t,e,n,a){return t===e||q.defined(t)&&q.defined(e)&&S.CrystalMath.equalsEpsilon(t.x,e.x,n,a)&&S.CrystalMath.equalsEpsilon(t.y,e.y,n,a)},P.ZERO=Object.freeze(new P(0,0)),P.UNIT_X=Object.freeze(new P(1,0)),P.UNIT_Y=Object.freeze(new P(0,1)),P.prototype.clone=function(t){return P.clone(this,t)},P.prototype.equals=function(t){return P.equals(this,t)},P.prototype.equalsEpsilon=function(t,e,n){return P.equalsEpsilon(this,t,e,n)},P.prototype.toString=function(){return"("+this.x+", "+this.y+")"},t.Cartesian2=P,t.Cartesian3=O,t.Cartographic=h,t.Ellipsoid=x,t.Rectangle=I});
