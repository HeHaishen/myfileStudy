define(["exports","./arrayRemoveDuplicates-72d928ba","./Cartesian2-fe435665","./when-23b1aa97","./Math-e9e583a9","./PolylinePipeline-1446d6ce"],function(e,m,A,C,w,f){"use strict";var i={};var b=new A.Cartographic,M=new A.Cartographic;function E(e,i,t,a){var r=(i=m.arrayRemoveDuplicates(i,A.Cartesian3.equalsEpsilon)).length;if(!(r<2)){var n=C.defined(a),o=C.defined(t),l=new Array(r),s=new Array(r),h=new Array(r),g=i[0];l[0]=g;var p=e.cartesianToCartographic(g,b);o&&(p.height=t[0]),s[0]=p.height,h[0]=n?a[0]:0;for(var y,c,d=s[0]===h[0],u=1,v=1;v<r;++v){var P=i[v],f=e.cartesianToCartographic(P,M);o&&(f.height=t[v]),d=d&&0===f.height,y=p,c=f,w.CrystalMath.equalsEpsilon(y.latitude,c.latitude,w.CrystalMath.EPSILON10)&&w.CrystalMath.equalsEpsilon(y.longitude,c.longitude,w.CrystalMath.EPSILON10)?p.height<f.height&&(s[u-1]=f.height):(l[u]=P,s[u]=f.height,h[u]=n?a[v]:0,d=d&&s[u]===h[u],A.Cartographic.clone(f,p),++u)}if(!(d||u<2))return l.length=u,s.length=u,h.length=u,{positions:l,topHeights:s,bottomHeights:h}}}var F=new Array(2),H=new Array(2),L={positions:void 0,height:void 0,granularity:void 0,ellipsoid:void 0};i.computePositions=function(e,i,t,a,r,n){var o=E(e,i,t,a);if(C.defined(o)){i=o.positions,t=o.topHeights,a=o.bottomHeights;var l=i.length,o=l-2,s=w.CrystalMath.chordLength(r,e.maximumRadius),h=L;if(h.minDistance=s,h.ellipsoid=e,n){for(var g=0,p=0;p<l-1;p++)g+=f.PolylinePipeline.numberOfPoints(i[p],i[p+1],s)+1;var y=new Float64Array(3*g),c=new Float64Array(3*g),d=F,u=H;h.positions=d,h.height=u;var v=0;for(p=0;p<l-1;p++){d[0]=i[p],d[1]=i[p+1],u[0]=t[p],u[1]=t[p+1];var P=f.PolylinePipeline.generateArc(h);y.set(P,v),u[0]=a[p],u[1]=a[p+1],c.set(f.PolylinePipeline.generateArc(h),v),v+=P.length}}else h.positions=i,h.height=t,y=new Float64Array(f.PolylinePipeline.generateArc(h)),h.height=a,c=new Float64Array(f.PolylinePipeline.generateArc(h));return{bottomPositions:c,topPositions:y,numCorners:o}}},e.WallGeometryLibrary=i});
