define(["./Cartesian2-fe435665","./AttributeCompression-dc95bf1b","./Math-e9e583a9","./IndexDatatype-5483de1e","./createTaskProcessorWorker","./when-23b1aa97","./WebGLConstants-c32c4572"],function(P,L,S,_,a,r,e){"use strict";var G=32767,W=new P.Cartographic,B=new P.Cartesian3;var z=new P.Rectangle,H=new P.Ellipsoid,O=new P.Cartesian3,Y={min:void 0,max:void 0};var Z=new P.Cartesian3,j=new P.Cartesian3,q=new P.Cartesian3,J=new P.Cartesian3,K=new P.Cartesian3;return a(function(a,r){var e=new Uint16Array(a.positions),t=new Uint16Array(a.widths),n=new Uint32Array(a.counts),i=new Uint16Array(a.batchIds);!function(a){a=new Float64Array(a);var r=0;Y.min=a[r++],Y.max=a[r++],P.Rectangle.unpack(a,2,z),r+=P.Rectangle.packedLength,P.Ellipsoid.unpack(a,r,H),r+=P.Ellipsoid.packedLength,P.Cartesian3.unpack(a,r,O)}(a.packedBuffer);for(var s=O,u=function(a,r,e,t,n){var i=a.length/3,s=a.subarray(0,i),u=a.subarray(i,2*i),c=a.subarray(2*i,3*i);L.AttributeCompression.zigZagDeltaDecode(s,u,c);for(var o=new Float64Array(a.length),f=0;f<i;++f){var p=s[f],C=u[f],d=c[f],p=S.CrystalMath.lerp(r.west,r.east,p/G),C=S.CrystalMath.lerp(r.south,r.north,C/G),d=S.CrystalMath.lerp(e,t,d/G),d=P.Cartographic.fromRadians(p,C,d,W),d=n.cartographicToCartesian(d,B);P.Cartesian3.pack(d,o,3*f)}return o}(e,z,Y.min,Y.max,H),e=4*(a=u.length/3)-4,c=new Float32Array(3*e),o=new Float32Array(3*e),f=new Float32Array(3*e),p=new Float32Array(2*e),C=new Uint16Array(e),d=0,b=0,l=0,w=0,y=n.length,h=0;h<y;++h){for(var k,v=n[h],A=t[h],g=i[h],x=0;x<v;++x){0===x?(m=P.Cartesian3.unpack(u,3*w,Z),E=P.Cartesian3.unpack(u,3*(w+1),j),k=P.Cartesian3.subtract(m,E,q),P.Cartesian3.add(m,k,k)):k=P.Cartesian3.unpack(u,3*(w+x-1),q);var E,m,D,I=P.Cartesian3.unpack(u,3*(w+x),J);x===v-1?(E=P.Cartesian3.unpack(u,3*(w+v-1),Z),m=P.Cartesian3.unpack(u,3*(w+v-2),j),D=P.Cartesian3.subtract(E,m,K),P.Cartesian3.add(E,D,D)):D=P.Cartesian3.unpack(u,3*(w+x+1),K),P.Cartesian3.subtract(k,s,k),P.Cartesian3.subtract(I,s,I),P.Cartesian3.subtract(D,s,D);for(var T=x===v-1?2:4,U=0===x?2:0;U<T;++U){P.Cartesian3.pack(I,c,d),P.Cartesian3.pack(k,o,d),P.Cartesian3.pack(D,f,d),d+=3;var F=U-2<0?-1:1;p[b++]=U%2*2-1,p[b++]=F*A,C[l++]=g}}w+=v}var N=_.IndexDatatype.createTypedArray(e,6*a-6),R=0,M=0,y=a-1;for(h=0;h<y;++h)N[M++]=R,N[M++]=R+2,N[M++]=R+1,N[M++]=R+1,N[M++]=R+2,N[M++]=R+3,R+=4;return r.push(c.buffer,o.buffer,f.buffer),r.push(p.buffer,C.buffer,N.buffer),{indexDatatype:2===N.BYTES_PER_ELEMENT?_.IndexDatatype.UNSIGNED_SHORT:_.IndexDatatype.UNSIGNED_INT,currentPositions:c.buffer,previousPositions:o.buffer,nextPositions:f.buffer,expandAndWidth:p.buffer,batchIds:C.buffer,indices:N.buffer}})});
